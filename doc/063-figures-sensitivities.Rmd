## SENSITIVITY MODEL FIGURES

<!-- Vartheta and sigma, and steepness  -------------------------------------->

(ref:fig-sens-variance-en) Spawning biomass for sensitivities to changes in the $\vartheta^2$ and $\rho$ parameters (due to changes to $\sigma$ and $\tau$), and steepness ($h$) parameter. The $B_0$ estimates for the '`r names(models$sens_grps[[1]])[2]`' and '`r names(models$sens_grps[[1]])[3]`' models are outside the axis limits. For the sake of clarity of the trajectories, they were left off the plot. They are estimated as `r sens_1_2_sbo$est` thousand t and `r sens_1_3_sbo$est` thousand t respectively.

(ref:fig-sens-variance-fr) French here

```{r fig-sens-variance, fig.cap = ifelse(fr(), "(ref:fig-sens-variance-fr)", "(ref:fig-sens-variance-en)")}
plot_biomass_mcmc(models$sens_grps[[1]],
                  angle_x_labels = TRUE,
                  text_title_size = NULL,
                  show_bo_lines = TRUE,
                  line_width = 0.5,
                  point_size = 1.5,
                  ylim = c(0, 350))
```

(ref:fig-sens-variance-rel-en) Relative spawning biomass for sensitivities to changes in the $\vartheta^2$ and $\rho$ parameters (due to changes to $\sigma$ and $\tau$), and steepness ($h$) parameter.

(ref:fig-sens-variance-rel-fr) French here

```{r fig-sens-variance-rel, fig.cap = ifelse(fr(), "(ref:fig-sens-variance-rel-fr)", "(ref:fig-sens-variance-rel-en)")}
plot_biomass_mcmc(models$sens_grps[[1]],
                  rel = TRUE,
                  angle_x_labels = TRUE,
                  text_title_size = NULL,
                  show_bo_lines = TRUE,
                  line_width = 0.5,
                  point_size = 1.5,
                  ylim = c(0, 1.3))
```

(ref:fig-sens-steepness-prior-en) Priors and posteriors for the sensitivity in which the steepness prior was changed. This can be compared to the base model in Figure \@ref(fig:fig-base-priors-posts).

(ref:fig-sens-steepness-prior-fr) French caption here

```{r sens-steepness-prior, fig.cap = ifelse(fr(), "(ref:fig-sens-steepness-prior-fr)", "(ref:fig-sens-steepness-prior-en)"), out.width = "100%"}
plot_priors_posts_mcmc(models$sens_grps[[1]][[5]],
                       param_rm = c("sel",
                                    "bo",
                                    "tau",
                                    "sigma",
                                    "log_m_sex1",
                                    "log_m_sex2",
                                    "so", "beta", "phie"))
```

<!-- Natural mortality ------------------------------------------------------->

(ref:fig-sens-m-en) Spawning biomass for sensitivities to changes in the natural mortality ($M$) parameters. In the base model, this parameter is fixed for both male and females. In these sensitivities, it is estimated for the sex in question in addition to the changes in prior, while the parameter for the opposite sex remains fixed.

(ref:fig-sens-m-fr) French here

```{r fig-sens-m, fig.cap = ifelse(fr(), "(ref:fig-sens-m-fr)", "(ref:fig-sens-m-en)")}
plot_biomass_mcmc(models$sens_grps[[2]],
                  angle_x_labels = TRUE,
                  show_bo_lines = TRUE)
```

(ref:fig-sens-m-rel-en) Relative spawning biomass for sensitivities to changes in the natural mortality ($M$) parameters.

(ref:fig-sens-m-rel-fr) French here

```{r fig-sens-m-rel, fig.cap = ifelse(fr(), "(ref:fig-sens-m-rel-fr)", "(ref:fig-sens-m-rel-en)")}
plot_biomass_mcmc(models$sens_grps[[2]],
                  rel = TRUE,
                  angle_x_labels = TRUE,
                  show_bo_lines = TRUE)
```

<!-- Catchability ------------------------------------------------------------>

(ref:fig-sens-q-en) Spawning biomass for the sensitivities to changes in the catchability ($q_k$) parameters. For these sensitivities the priors for all gears ($k$) are modified in the same way.

(ref:fig-sens-q-fr) French here

```{r fig-sens-q-m, fig.cap = ifelse(fr(), "(ref:fig-sens-q-fr)", "(ref:fig-sens-q-en)")}
plot_biomass_mcmc(models$sens_grps[[3]],
                  angle_x_labels = TRUE,
                  text_title_size = NULL,
                  show_bo_lines = TRUE)
```

(ref:fig-sens-q-rel-en) Relative spawning biomass for the sensitivities to changes in the priors for the catchability ($q_k$) parameters. For these sensitivities the priors for all gears ($k$) are modified in the same way.

(ref:fig-sens-q-rel-fr) French here

```{r fig-sens-q-rel, fig.cap = ifelse(fr(), "(ref:fig-sens-q-rel-fr)", "(ref:fig-sens-q-rel-en)")}
plot_biomass_mcmc(models$sens_grps[[3]],
                  rel = TRUE,
                  angle_x_labels = TRUE,
                  text_title_size = NULL,
                  show_bo_lines = TRUE)
```

(ref:fig-sens-q-q-en) Catchability estimates for the sensitivities to changes in the priors for the catchability ($q_k$) parameters. The points are the median of the posterior and the vertical lines are the 95% CI.

(ref:fig-sens-q-q-fr) French here

```{r fig-sens-q-q, fig.cap = ifelse(fr(), "(ref:fig-sens-q-q-fr)", "(ref:fig-sens-q-q-en)")}
plot_q_mcmc(models$sens_grps[[3]],
            leg_loc = "facet",
            gear = NULL)
```

<!-- Selectivity and Geostat surveys ----------------------------------------->

(ref:fig-sens-selex-en) Spawning biomass for the sensitivities to changes in the selectivity parameters ($\hat{a}_k$ and $\gamma_k$). For the first sensitivity, the selectivities for the two commercial trawl fisheries are fixed to the maturity for the two commercial trawl gears ($k$). For the second, the `r qcs` has three year blocks or time-varying selectivity, 2003--2010, 2011--2016, and 2017--2021.

(ref:fig-sens-selex-fr) French here

```{r fig-sens-selex, fig.cap = ifelse(fr(), "(ref:fig-sens-selex-fr)", "(ref:fig-sens-selex-en)")}
plot_biomass_mcmc(models$sens_grps[[4]],
                  angle_x_labels = TRUE,
                  text_title_size = NULL,
                  show_bo_lines = TRUE)
```

(ref:fig-sens-selex-rel-en) Relative spawning biomass for the sensitivities to changes in the selectivity ($\hat{a}_k$ and $\gamma_k$) parameters.

(ref:fig-sens-selex-rel-fr) French here

```{r fig-sens-selex-rel, fig.cap = ifelse(fr(), "(ref:fig-sens-selex-rel-fr)", "(ref:fig-sens-selex-rel-en)")}
plot_biomass_mcmc(models$sens_grps[[4]],
                  rel = TRUE,
                  angle_x_labels = TRUE,
                  text_title_size = NULL,
                  show_bo_lines = TRUE)
```

(ref:fig-sens-sel-eq-mat-vuln-en) Spawning biomass and vulnerable biomass for the sensitivity model for which the selectivity has been set equal to the maturity for the two commercial trawl fleets. The spawning biomass is in black and has its 95% CI shaded. The two vulnerable biomass trajectories have their 95% CI contained withing the dotted lines of their respective colours.

(ref:fig-sens-sel-eq-mat-vuln-fr) French here

```{r fig-sens-sel-eq-mat-vuln, fig.cap = ifelse(fr(), "(ref:fig-sens-sel-eq-mat-vuln-fr)", "(ref:fig-sens-sel-eq-mat-vuln-en)")}
plot_vuln_mcmc(models$sens_grps[[4]][[2]],
               angle_x_labels = TRUE,
               xlim = c(1997, 2021),
               ylim = c(0, 800))
```


(ref:fig-sens-selex-index-fits-en) Index fits for the sensitivity where the `r qcs` has time-varying selectivity.

(ref:fig-sens-selex-index-fits-fr) French here

```{r fig-sens-selex-index-fits, fig.cap = ifelse(fr(), "(ref:fig-sens-selex-index-fits-fr)", "(ref:fig-sens-selex-index-fits-en)")}
plot_index_mcmc(models$sens_grps[[4]],
                type = "fits",
                surv_index = survey_index,
                leg_loc = "facet",
                text_title_size = NULL)

```

<!-- QCS TV selectivity -->

(ref:fig-sens-qcs-tv-en) Time-varying selectivity for the `r qcs`, where the panels are blocks of years: 2003--2010 (left), 2011--2016 (middle), and 2017--2021 (right). See Figure \@ref(fig:fig-base-mcmc-selex) for more information.

(ref:fig-sens-qcs-tv-fr) French here

```{r fig-sens-qcs-tv, fig.cap = ifelse(fr(), "(ref:fig-sens-qcs-tv-fr)", "(ref:fig-sens-qcs-tv-en)")}
plot_selex_gear_mcmc(models$sens_grps[[4]][[3]], gear = 3, show_maturity = TRUE)
```

(ref:fig-sens-qcs-autocor-sel-en) Autocorrelation for estimated selectivity parameters for the sensitivity model which has time-varying selectivity for the `r qcs`. See Figure \@ref(fig:fig-base-trace-selex) for descriptions of the parameter subscripts.

(ref:fig-sens-qcs-autocor-sel-fr) French here

```{r fig-sens-qcs-autocor-sel, fig.cap = ifelse(fr(), "(ref:fig-sens-qcs-autocor-sel-fr)", "(ref:fig-sens-qcs-autocor-sel-en)"), fig.asp = 1}
plot_autocorr_mcmc(models$sens_grps[[4]][[3]],
                   plot_sel = TRUE, 
                   text_title_size = NULL,
                   lag_max = 1000,
                   rows_cols = c(7, 4),
                   col = "blue",
                   lwd = 2)
```

(ref:fig-sens-qcs-trace-sel-tv-en) Trace plots for selectivity parameters for the sensitivity model which has time-varying selectivity for the `r qcs`. See Figure \@ref(fig:fig-base-autocor-selex) for parameter and subscript descriptions.

(ref:fig-sens-qcs-trace-sel-tv-fr) French here

```{r fig-sens-qcs-trace-sel-tv, fig.cap = ifelse(fr(), "(ref:fig-sens-qcs-trace-sel-tv-fr)", "(ref:fig-sens-qcs-trace-sel-tv-en)"),  fig.asp = 1}
plot_traces_mcmc(models$sens_grps[[4]][[3]],
                 plot_sel = TRUE, 
                 text_title_size = NULL,
                 col = "blue",
                 lwd = 2)
```

<!-- Geostatistical -->

(ref:fig-sens-geostat-en) Spawning biomass for the sensitivity in which the design-based survey index data has been replaced with geostatistical-based survey indices. See Appendix \@ref(app:geostat).

(ref:fig-sens-geostat-fr) French here

```{r fig-sens-geostat, fig.cap = ifelse(fr(), "(ref:fig-sens-geostat-fr)", "(ref:fig-sens-geostat-en)")}
plot_biomass_mcmc(models$sens_grps[[5]],
                  angle_x_labels = TRUE,
                  text_title_size = NULL,
                  show_bo_lines = TRUE,
                  ylim = c(0, 270))
```

(ref:fig-sens-geostat-rel-en) Relative spawning biomass for the sensitivity in which the design-based survey index data has been replaced with geostatistical-based survey indices. See Appendix \@ref(app:geostat).

(ref:fig-sens-geostat-rel-fr) French here

```{r fig-sens-geostat-rel, fig.cap = ifelse(fr(), "(ref:fig-sens-geostat-rel-fr)", "(ref:fig-sens-geostat-rel-en)")}
plot_biomass_mcmc(models$sens_grps[[5]],
                  angle_x_labels = TRUE,
                  text_title_size = NULL,
                  show_bo_lines = TRUE,
                  rel = TRUE,
                  ylim = c(0, 1.3))
```

(ref:fig-sens-geostat-index-fits-en) Index fits for the sensitivity in which the design-based survey index data has been replaced with geostatistical-based survey indices. See Appendix \@ref(app:geostat).

(ref:fig-sens-geostat-index-fits-fr) French here

```{r fig-sens-geostat-index-fits, fig.cap = ifelse(fr(), "(ref:fig-sens-geostat-index-fits-fr)", "(ref:fig-sens-geostat-index-fits-en)")}
plot_index_mcmc(models$sens_grps[[5]][[2]],
                type = "fits",
                surv_index = survey_index_geo,
                leg_loc = NULL,
                text_title_size = NULL)

```

(ref:fig-sens-meeting-en) Spawning biomass for the sensitivities involving removing the DCPUE index, fixing selectivities and maturities, and modifying the maturity ogive. These sensitivities were added during the formal review meeting in October 2022.

(ref:fig-sens-meeting-fr) French here

```{r fig-sens-meeting, fig.cap = ifelse(fr(), "(ref:fig-sens-meeting-fr)", "(ref:fig-sens-meeting-en)")}
plot_biomass_mcmc(models$sens_grps[[6]],
                  angle_x_labels = TRUE,
                  text_title_size = NULL,
                  show_bo_lines = TRUE,
                  ylim = c(0, 270))
```

(ref:fig-sens-meeting-rel-en) Relative spawning biomass for the sensitivities involving removing the DCPUE index, fixing selectivities and maturities, and modifying the maturity ogive. These sensitivities were added during the formal review meeting in October 2022.

(ref:fig-sens-meeting-rel-fr) French here

```{r fig-sens-meeting-rel, fig.cap = ifelse(fr(), "(ref:fig-sens-meeting-rel-fr)", "(ref:fig-sens-meeting-rel-en)")}
plot_biomass_mcmc(models$sens_grps[[6]],
                  rel = TRUE,
                  angle_x_labels = TRUE,
                  text_title_size = NULL,
                  show_bo_lines = TRUE,
                  ylim = c(0, 1.2))
```

(ref:fig-sens-remove-dcpue-index-fits-en) Index fits for the sensitivities involving removing the DCPUE index, fixing selectivities and maturities, and modifying the maturity ogive.

(ref:fig-sens-remove-dcpue-index-fits-fr) French here

```{r fig-sens-remove-dcpue-index-fits, fig.cap = ifelse(fr(), "(ref:fig-sens-remove-dcpue-index-fits-fr)", "(ref:fig-sens-remove-dcpue-index-fits-en)")}
plot_index_mcmc(models$sens_grps[[6]],
                type = "fits",
                surv_index = survey_index,
                leg_loc = "facet",
                text_title_size = NULL)

```

(ref:fig-sens-meeting-vuln-en) Spawning biomass and vulnerable biomass for the sensitivities involving removing the DCPUE index, fixing selectivities and maturities, and modifying the maturity ogive.

(ref:fig-sens-meeting-vuln-fr) French here

```{r fig-sens-meeting-vuln, fig.cap = ifelse(fr(), "(ref:fig-sens-meeting-vuln-fr)", "(ref:fig-sens-meeting-vuln-en)")}
plot_vuln_mcmc(models$sens_grps[[6]][[3]], 
               angle_x_labels = TRUE,
               leg_loc = c(0.05, 0.05),
               ylim = c(0, 150))
```



\clearpage
