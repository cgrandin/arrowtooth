## SENSITIVITY MODEL FIGURES

<!-- Vartheta and sigma, and steepness  -------------------------------------->

(ref:fig-sens-variance-en) Spawning biomass for sensitivities to changes in the $\vartheta^2$ and $\rho$ parameters (due to changes to $\sigma$ and $\tau$), and steepness ($h$) parameter. The $B_0$ estimates for the '`r names(models$sens_grps[[1]])[2]`' and '`r names(models$sens_grps[[1]])[3]`' models are outside the axis limits. For the sake of clarity of the trajectories, they were left off the plot. They are estimated as `r sens_1_2_sbo$est` thousand t and `r sens_1_3_sbo$est` thousand t respectively.

(ref:fig-sens-variance-fr) French here

```{r fig-sens-variance, fig.cap = ifelse(fr(), "(ref:fig-sens-variance-fr)", "(ref:fig-sens-variance-en)")}
plot_biomass_mcmc(models$sens_grps[[1]],
                  angle_x_labels = TRUE,
                  text_title_size = NULL,
                  show_bo_lines = TRUE,
                  line_width = 0.5,
                  point_size = 1.5,
                  ylim = c(0, 350))
```

(ref:fig-sens-variance-rel-en) Relative spawning biomass for sensitivities to changes in the $\vartheta^2$ and $\rho$ parameters (due to changes to $\sigma$ and $\tau$), and steepness ($h$) parameter.

(ref:fig-sens-variance-rel-fr) French here

```{r fig-sens-variance-rel, fig.cap = ifelse(fr(), "(ref:fig-sens-variance-rel-fr)", "(ref:fig-sens-variance-rel-en)")}
plot_biomass_mcmc(models$sens_grps[[1]],
                  rel = TRUE,
                  angle_x_labels = TRUE,
                  text_title_size = NULL,
                  show_bo_lines = TRUE,
                  line_width = 0.5,
                  point_size = 1.5,
                  ylim = c(0, 0.8))
```

(ref:fig-sens-variance-prior-post-en) Priors and posteriors for the sensitivity in which $\sigma$ is reduced. This can be compared to the base model in Figure \@ref(fig:fig-base-priors-posts).

(ref:fig-sens-variance-prior-post-fr) French here

```{r fig-sens-variance-prior-post, fig.cap = ifelse(fr(), "(ref:fig-sens-variance-prior-post-fr)", "(ref:fig-sens-variance-prior-post-en)")}
plot_priors_posts_mcmc(models$sens_grps[[1]][[2]],
                       param_rm = c("sel",
                                    "bo",
                                    "tau",
                                    "sigma",
                                    "log_m_sex1",
                                    "log_m_sex2"))
```

(ref:fig-sens-steepness-prior-en) Priors and posteriors for the sensitivity in which the steepness prior was changed. This can be compared to the base model in Figure \@ref(fig:fig-base-priors-posts).

(ref:fig-sens-steepness-prior-fr) French caption here

```{r sens-steepness-prior, fig.cap = ifelse(fr(), "(ref:fig-sens-steepness-prior-fr)", "(ref:fig-sens-steepness-prior-en)"), out.width = "100%"}
plot_priors_posts_mcmc(models$sens_grps[[1]][[5]],
                       param_rm = c("sel",
                                    "bo",
                                    "tau",
                                    "sigma",
                                    "log_m_sex1",
                                    "log_m_sex2"))
```

<!-- Natural mortality ------------------------------------------------------->

(ref:fig-sens-m-en) Spawning biomass for sensitivities to changes in the natural mortality ($M$) parameters. In the base model, this parameter is fixed for both male and females. In these sensitivities, it is estimated for the sex in question in addition to the changes in prior, while the parameter for the opposite sex remains fixed.

(ref:fig-sens-m-fr) French here

```{r fig-sens-m, fig.cap = ifelse(fr(), "(ref:fig-sens-m-fr)", "(ref:fig-sens-m-en)")}
plot_biomass_mcmc(models$sens_grps[[2]],
                  angle_x_labels = TRUE,
                  show_bo_lines = TRUE)
```

(ref:fig-sens-m-rel-en) Relative spawning biomass for sensitivities to changes in the natural mortality ($M$) parameters.

(ref:fig-sens-m-rel-fr) French here

```{r fig-sens-m-rel, fig.cap = ifelse(fr(), "(ref:fig-sens-m-rel-fr)", "(ref:fig-sens-m-rel-en)")}
plot_biomass_mcmc(models$sens_grps[[2]],
                  rel = TRUE,
                  angle_x_labels = TRUE,
                  show_bo_lines = TRUE)
```

(ref:fig-sens-m-index-en) Index fits for sensitivity models that include estimation of $M$ parameters.

(ref:fig-sens-m-index-fr) French here

```{r fig-sens-m-index, fig.cap = ifelse(fr(), "(ref:fig-sens-m-index-fr)", "(ref:fig-sens-m-index-en)")}
plot_index_mcmc(models$sens_grps[[2]],
                type = "fits",
                surv_index = survey_index,
                leg_loc = "facet")

```

<!-- Catchability ------------------------------------------------------------>

(ref:fig-sens-q-en) Spawning biomass for the sensitivities to changes in the catchability ($q_k$) parameters. For these sensitivities the priors for all gears ($k$) are modified in the same way.

(ref:fig-sens-q-fr) French here

```{r fig-sens-q-m, fig.cap = ifelse(fr(), "(ref:fig-sens-q-fr)", "(ref:fig-sens-q-en)")}
plot_biomass_mcmc(models$sens_grps[[3]],
                  angle_x_labels = TRUE,
                  text_title_size = NULL,
                  show_bo_lines = TRUE)
```

(ref:fig-sens-q-rel-en) Relative spawning biomass for the sensitivities to changes in the priors for the catchability ($q_k$) parameters. For these sensitivities the priors for all gears ($k$) are modified in the same way.

(ref:fig-sens-q-rel-fr) French here

```{r fig-sens-q-rel, fig.cap = ifelse(fr(), "(ref:fig-sens-q-rel-fr)", "(ref:fig-sens-q-rel-en)")}
plot_biomass_mcmc(models$sens_grps[[3]],
                  rel = TRUE,
                  angle_x_labels = TRUE,
                  text_title_size = NULL,
                  show_bo_lines = TRUE)
```

(ref:fig-sens-q-q-en) Catchability estimates for the sensitivities to changes in the priors for the catchability ($q_k$) parameters. The points are the median of the posterior and the vertical lines are the 95% CI.

(ref:fig-sens-q-q-fr) French here

```{r fig-sens-q-q, fig.cap = ifelse(fr(), "(ref:fig-sens-q-q-fr)", "(ref:fig-sens-q-q-en)")}
plot_q_mcmc(models$sens_grps[[3]],
            leg_loc = "facet",
            gear = NULL)
```

(ref:fig-sens-q-index-en) Index fits for the sensitivities to changes in the priors for the catchability ($q_k$) parameters.

(ref:fig-sens-q-index-fr) French here

```{r fig-sens-q-index, fig.cap = ifelse(fr(), "(ref:fig-sens-q-index-fr)", "(ref:fig-sens-q-index-en)")}
plot_index_mcmc(models$sens_grps[[3]],
                type = "fits",
                surv_index = survey_index,
                leg_loc = "facet",
                text_title_size = NULL)

```

<!-- Selectivity and Geostat surveys ----------------------------------------->

(ref:fig-sens-selex-en) Spawning biomass for the sensitivities to changes in the selectivity parameters ($\hat{a}_k$ and $\gamma_k$). For the first sensitivity, the selectivities for the two commercial trawl fisheries are fixed to the maturity for the two commercial trawl gears ($k$). For the second, the `r qcs` has three year blocks or time-varying selectivity, 2003--2010, 2011--2016, and 2017--2021.

(ref:fig-sens-selex-fr) French here

```{r fig-sens-selex, fig.cap = ifelse(fr(), "(ref:fig-sens-selex-fr)", "(ref:fig-sens-selex-en)")}
plot_biomass_mcmc(models$sens_grps[[4]],
                  angle_x_labels = TRUE,
                  text_title_size = NULL,
                  show_bo_lines = TRUE)
```

(ref:fig-sens-selex-rel-en) Relative spawning biomass for the sensitivities to changes in the selectivity ($\hat{a}_k$ and $\gamma_k$) parameters.

(ref:fig-sens-selex-rel-fr) French here

```{r fig-sens-selex-rel, fig.cap = ifelse(fr(), "(ref:fig-sens-selex-rel-fr)", "(ref:fig-sens-selex-rel-en)")}
plot_biomass_mcmc(models$sens_grps[[4]],
                  rel = TRUE,
                  angle_x_labels = TRUE,
                  text_title_size = NULL,
                  show_bo_lines = TRUE)
```

(ref:fig-sens-selex-index-fits-en) Index fits for the sensitivity where the `r qcs` has time-varying selectivity.

(ref:fig-sens-selex-index-fits-fr) French here

```{r fig-sens-selex-index-fits, fig.cap = ifelse(fr(), "(ref:fig-sens-selex-index-fits-fr)", "(ref:fig-sens-selex-index-fits-en)")}
plot_index_mcmc(models$sens_grps[[4]],
                type = "fits",
                surv_index = survey_index,
                leg_loc = "facet",
                text_title_size = NULL)

```

(ref:fig-sens-sel-eq-mat-autocor-en) Autocorrelation for non-selectivity parameters for the sensitivity model which has both commercial fleets' selectivity fixed to maturity. See Figure \@ref(fig:fig-base-priors-posts) for $q$ subscript descriptions.

(ref:fig-sens-sel-eq-mat-autocor-fr) French here

```{r fig-sens-sel-eq-mat-autocor, fig.cap = ifelse(fr(), "(ref:fig-sens-sel-eq-mat-autocor-fr)", "(ref:fig-sens-sel-eq-mat-autocor-en)")}
plot_autocorr_mcmc(models$sens_grps[[4]][[2]],
                   plot_sel = FALSE, 
                   param_rm = c("m1", "m2", "rho", "bo",
                                "ssb", "vartheta", "bmsy",
                                "fmsy1", "fmsy2", "umsy1",
                                "umsy2", "msy1", "msy2"),
                   rows_cols = c(3, 4),
                   text_title_size = NULL,
                   lag_max = 1000,
                   col = "blue",
                   lwd = 2)
```

(ref:fig-sens-sel-eq-mat-autocor-sel-en) Autocorrelation for estimated selectivity parameters for the sensitivity model which has both commercial fleets' selectivity fixed to maturity. See Figure \@ref(fig:fig-base-trace-selex) for descriptions of the parameter subscripts.

(ref:fig-sens-sel-eq-mat-autocor-sel-fr) French here

```{r fig-sens-sel-eq-mat-autocor-sel, fig.cap = ifelse(fr(), "(ref:fig-sens-sel-eq-mat-autocor-sel-fr)", "(ref:fig-sens-sel-eq-mat-autocor-sel-en)")}
plot_autocorr_mcmc(base_model,
                   plot_sel = TRUE, 
                   text_title_size = NULL,
                   lag_max = 1000,
                   col = "blue",
                   lwd = 2)
```

<!-- QCS TV selectivity -->

(ref:fig-sens-qcs-tv-en) Time-varying selectivity for the `r qcs`, where the panels are blocks of years: 2003--2010 (left), 2011--2016 (middle), and 2017--2021 (right). See Figure \@ref(fig:fig-base-mcmc-selex) for more information.

(ref:fig-sens-qcs-tv-fr) French here

```{r fig-sens-qcs-tv, fig.cap = ifelse(fr(), "(ref:fig-sens-qcs-tv-fr)", "(ref:fig-sens-qcs-tv-en)")}
plot_selex_gear_mcmc(models$sens_grps[[4]][[3]], gear = 3, show_maturity = TRUE)
```

(ref:fig-sens-qcs-tv-autocor-en) Autocorrelation for non-selectivity parameters for the sensitivity model which has time-varying selectivity for the `r qcs`. See Figure \@ref(fig:fig-base-priors-posts) for $q$ subscript descriptions.

(ref:fig-sens-qcs-tv-autocor-fr) French here

```{r fig-sens-qcs-autocor-tv, fig.cap = ifelse(fr(), "(ref:fig-sens-qcs-tv-autocor-fr)", "(ref:fig-sens-qcs-tv-autocor-en)")}
plot_autocorr_mcmc(models$sens_grps[[4]][[3]],
                   plot_sel = FALSE, 
                   param_rm = c("m1", "m2", "rho", "bo",
                                "ssb", "vartheta", "bmsy",
                                "fmsy1", "fmsy2", "umsy1",
                                "umsy2", "msy1", "msy2"),
                   rows_cols = c(3, 4),
                   text_title_size = NULL,
                   lag_max = 1000,
                   col = "blue",
                   lwd = 2)
```

(ref:fig-sens-qcs-sel-en) Autocorrelation for estimated selectivity parameters for the sensitivity model which has time-varying selectivity for the `r qcs`. See Figure \@ref(fig:fig-base-trace-selex) for descriptions of the parameter subscripts.

(ref:fig-sens-qcs-sel-fr) French here

```{r fig-sens-qcs-sel, fig.cap = ifelse(fr(), "(ref:fig-sens-qcs-sel-fr)", "(ref:fig-sens-qcs-sel-en)")}
plot_autocorr_mcmc(models$sens_grps[[4]][[3]],
                   plot_sel = TRUE, 
                   text_title_size = NULL,
                   lag_max = 1000,
                   col = "blue",
                   lwd = 2)
```

(ref:fig-sens-qcs-tv-trace-en) Trace plots for non-selectivity parameters for the sensitivity model which has time-varying selectivity for the `r qcs`. See Figure \@ref(fig:fig-base-trace) for parameter and subscript descriptions.

(ref:fig-sens-qcs-tv-trace-fr) French here

```{r fig-sens-qcs-trace-tv, fig.cap = ifelse(fr(), "(ref:fig-sens-qcs-tv-trace-fr)", "(ref:fig-sens-qcs-tv-trace-en)")}
plot_traces_mcmc(models$sens_grps[[4]][[3]],
                 plot_sel = FALSE, 
                 param_rm = c("m1", "m2", "rho", "ssb", "vartheta",
                              "bo", "msy1", "msy2", "fmsy1", "fmsy2",
                              "umsy1", "umsy2","bmsy"),
                 text_title_size = NULL)
```

(ref:fig-sens-qcs-tv-trace-sel-en) Trace plots for selectivity parameters for the sensitivity model which has time-varying selectivity for the `r qcs`. See Figure \@ref(fig:fig-base-autocor-selex) for parameter and subscript descriptions.

(ref:fig-sens-qcs-tv-trace-sel-fr) French here

```{r fig-sens-qcs-trace-sel-tv, fig.cap = ifelse(fr(), "(ref:fig-sens-qcs-tv-trace-sel-fr)", "(ref:fig-sens-qcs-tv-trace-sel-en)")}
plot_traces_mcmc(models$sens_grps[[4]][[3]],
                 plot_sel = TRUE, 
                 text_title_size = NULL,
                 col = "blue",
                 lwd = 2)
```

<!-- Geostatistical -->

(ref:fig-sens-geostat-en) Spawning biomass for the sensitivity in which the design-based survey index data has been replaced with geostatistical-based survey indices. See Appendix \@ref(app:geostat).

(ref:fig-sens-geostat-fr) French here

```{r fig-sens-geostat, fig.cap = ifelse(fr(), "(ref:fig-sens-geostat-fr)", "(ref:fig-sens-geostat-en)")}
plot_biomass_mcmc(models$sens_grps[[5]],
                  angle_x_labels = TRUE,
                  text_title_size = NULL,
                  show_bo_lines = TRUE,
                  ylim = c(0, 270))
```

(ref:fig-sens-geostat-rel-en) Relative spawning biomass for the sensitivity in which the design-based survey index data has been replaced with geostatistical-based survey indices. See Appendix \@ref(app:geostat).

(ref:fig-sens-geostat-rel-fr) French here

```{r fig-sens-geostat-rel, fig.cap = ifelse(fr(), "(ref:fig-sens-geostat-rel-fr)", "(ref:fig-sens-geostat-rel-en)")}
plot_biomass_mcmc(models$sens_grps[[5]],
                  angle_x_labels = TRUE,
                  text_title_size = NULL,
                  show_bo_lines = TRUE,
                  rel = TRUE,
                  ylim = c(0, 0.8))
```

(ref:fig-sens-geostat-index-fits-en) Index fits for the sensitivity in which the design-based survey index data has been replaced with geostatistical-based survey indices. See Appendix \@ref(app:geostat).

(ref:fig-sens-geostat-index-fits-fr) French here

```{r fig-sens-geostat-index-fits, fig.cap = ifelse(fr(), "(ref:fig-sens-geostat-index-fits-fr)", "(ref:fig-sens-geostat-index-fits-en)")}
plot_index_mcmc(models$sens_grps[[5]][[2]],
                type = "fits",
                surv_index = survey_index_geo,
                leg_loc = "facet",
                text_title_size = NULL)

```

\clearpage
